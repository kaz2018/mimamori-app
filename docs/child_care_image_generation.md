# Child_Care_Agent 画像生成機能

## 概要

Child_Care_Agentは、GCPのVertex AI Imagenを使用して子供向けの画像を生成できます。ストーリーの挿絵やゲームのイラストを自動生成し、より魅力的な体験を提供します。

## 利用可能な画像生成ツール

### 1. generate_child_image
汎用的な子供向け画像生成

**パラメータ:**
- `prompt`: 画像生成のプロンプト
- `style`: 画像スタイル（children_book, cartoon, watercolor）

**使用例:**
```
「うさぎが森で友達と遊んでいる絵を描いて」
```

### 2. generate_story_illustration
ストーリー専用の挿絵生成

**パラメータ:**
- `story_title`: ストーリーのタイトル
- `scene_description`: シーンの説明

**使用例:**
```
ストーリー: 「うさぎの冒険」
シーン: 「うさぎが泣いているリスを見つける場面」
```

### 3. generate_game_illustration
ゲーム専用のイラスト生成

**パラメータ:**
- `game_type`: ゲームの種類
- `game_description`: ゲームの説明

**使用例:**
```
ゲーム: 「しりとり」
説明: 「りんごから始まるしりとりゲーム」
```

## 画像スタイル

### children_book（絵本風）
- 水彩画風
- ソフトなパステルカラー
- 親しみやすいキャラクター
- 温かみのある雰囲気

### cartoon（カートゥーン風）
- 明るい色合い
- シンプルなデザイン
- 丸い形
- 大きな目と表情豊かな顔

### watercolor（水彩画風）
- ソフトな色合い
- 優しい筆のタッチ
- 芸術的だがシンプル
- 落ち着いた雰囲気

## 安全設定

- **G-rated コンテンツ**: 3-6歳向けの適切な内容
- **暴力禁止**: 暴力的な要素は除外
- **暗いテーマ禁止**: 暗いテーマは除外
- **教育的価値**: 教育的で健全な内容
- **明るく楽しい雰囲気**: 明るく楽しい雰囲気を重視

## 使用例

### ストーリー読み聞かせ時
```
ユーザー: 「うさぎの冒険のお話を読んで」
エージェント: 「うさぎの冒険を読むね！まず、うさぎが森で友達を見つける場面の絵を描いてみるよ。」
→ generate_story_illustration を実行
```

### ゲーム時
```
ユーザー: 「しりとりをしたい」
エージェント: 「しりとりをしよう！りんごから始まるよ。りんごの絵を描いてみるね。」
→ generate_game_illustration を実行
```

### 自由な会話時
```
ユーザー: 「うさぎが宇宙に行く絵を描いて」
エージェント: 「うさぎが宇宙に行く絵を描いてみるね！宇宙船に乗って星を見ているうさぎの絵だよ。」
→ generate_child_image を実行
```

## 技術仕様

### Vertex AI Imagen設定
- **モデル**: imagegeneration@005
- **アスペクト比**: 4:3
- **安全性フィルター**: block_most
- **人物生成**: allow_adult

### プロンプト最適化
- 子供向けの安全な内容に自動調整
- 年齢適正な表現に変換
- 教育的価値を含む内容に最適化

## エラーハンドリング

画像生成でエラーが発生した場合：
1. **フォールバックメッセージ**: 子供に分かりやすい説明
2. **代替手段**: 言葉での説明や別の活動を提案
3. **継続性**: 画像がなくても活動を継続

## 環境設定

### 必要な環境変数
```bash
export GOOGLE_CLOUD_PROJECT="your-project-id"
export GOOGLE_APPLICATION_CREDENTIALS="path/to/service-account.json"
```

### 必要な権限
- Vertex AI User
- Vertex AI Service Agent
- Cloud Storage Object Viewer（画像保存時）

## パフォーマンス最適化

- **並行処理**: 複数の画像を同時生成可能
- **キャッシュ**: 同じプロンプトの画像を再利用
- **プログレス表示**: 生成進捗を子供に分かりやすく表示

## 今後の拡張予定

- **アニメーション**: 簡単なアニメーション生成
- **音声合成**: 画像に合わせた音声生成
- **インタラクティブ**: 子供が描いた絵の改善提案
- **パーソナライズ**: 子供の好みに合わせたスタイル調整
